---
title: Redis Streams
date: 2025-9-10 10:00:00
tags: [消息队列,Redis,中间件]
category: 中间件
---

### 前言

在《[消息队列入门](https://silentechoe.github.io/2025/09/05/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%85%A5%E9%97%A8/)》一文中简要介绍了分布式架构中消息队列的重要性，以及引入消息队列能带来哪些好处。消息队列支持组件通信的快速读写，很容易联想到Redis这种缓存中间件，因为Redis本身支持数据的高速访问，很符合消息队列对于读写性能需求。在轻量级应用的场景中，直接通过Redis来实现消息队列似乎是个不错的选择，无须引入更多的中间件设施，降低了运维成本……那么Redis适合做消息队列吗？

一般来说消息队列需要提供三个保证：1.消息保序 2.处理重复消息 3.保证消息的可靠性。

在Redis 5.0版本前实现消息队列有多种方案，但无法完美实现上述保证，比如PUB/SUB(发布/订阅模式)，基于List的消息队列解决方案，基于Soreted Set的实现。

Redis中Pub/Sub消息无法持久化，如果出现网络问题或中间件宕机，消息会直接丢失，无法保证消息的可靠性;Redis list没有消息多播，没有Ack机制，如果出现网络问题则会出现重复消费的问题;Redis Sorted Set不支持阻塞式获取消息，不支持分组消费。



### Redis Streams

Redis Streams 是 Redis 5.0 版本开始引入的新数据结构。它的设计目标之一就是为了让Redis拥有消息队列的能力，它补齐了原







Streams 是Redis 专门为消息队列设计的数据类型。

XADD 插入消息，保证有序，可以自动生成全局唯一ID

XREAD 用于读取消息，可以按ID读取数据

XREADGROUP 按消费组读取消息。



消息的全局唯一ID由两部分组成，第一部分是数据插入时，以毫秒为单位计算的时间戳，第二部分表示插入消息在当前毫秒内的消息序号，以0编号开始。



Streams 可以使用XGROUP创建消费组，创建消费组后Streams可以使用XREADGROUP命令让消费组内的消费者读取消息。
